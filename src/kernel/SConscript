from pathlib import Path, PurePath

root = PurePath(Path('.').absolute())

Import('gcc_env')
Import('nasm_env')
env = gcc_env
nasm = nasm_env

build = str(env['BUILD'] / root.relative_to(env['SRC']))

sources = Glob("*.c")
nasm_sources = 'asmfunc.asm'

nasm.Object(f'{build}\\asmfunc.obj', [nasm_sources], ASFLAGS='-f elf')

for source in sources:
    env.Object(f'{build}\\{source.name.split(".")[0]}', source)
